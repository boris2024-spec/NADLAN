# API ะฃะปะธั ะะทัะฐะธะปั - ะะพะบัะผะตะฝัะฐัะธั

## ๐ฏ ะะฑะทะพั

ะะฐััะธัะตะฝะธะต ัะธััะตะผั ะฐะฒัะพะดะพะฟะพะปะฝะตะฝะธั ะดะปั ะฒะบะปััะตะฝะธั ัะปะธั ะธะท ะพัะธัะธะฐะปัะฝะพะณะพ API data.gov.il. ะฃะปะธัั ัะธะปัััััััั ะฟะพ ะฒัะฑัะฐะฝะฝะพะผั ะณะพัะพะดั.

## ๐ฆ ะะพะฒัะต ะฒะพะทะผะพะถะฝะพััะธ

### ะคัะฝะบัะธะธ API (citiesApi.js)

#### `getStreetsByCity(cityName)`
ะะพะปััะธัั ะฒัะต ัะปะธัั ะฒ ะพะฟัะตะดะตะปะตะฝะฝะพะผ ะณะพัะพะดะต.

```javascript
import { getStreetsByCity } from '../services/citiesApi';

const streets = await getStreetsByCity('ืชื ืืืื - ืืคื');
// ะะพะทะฒัะฐัะฐะตั: ['ืืืืืืืฃ', 'ืืืืื', 'ืื ืืืืื', ...]
```

**ะัะพะฑะตะฝะฝะพััะธ:**
- ะััะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ ะฝะฐ 24 ัะฐัะฐ ะดะปั ะบะฐะถะดะพะณะพ ะณะพัะพะดะฐ
- ะะฒัะพะผะฐัะธัะตัะบะฐั ัะพััะธัะพะฒะบะฐ ะฝะฐ ะธะฒัะธัะต
- ะฃะดะฐะปะตะฝะธะต ะดัะฑะปะธะบะฐัะพะฒ
- ะะพ 5000 ัะปะธั ะฝะฐ ะณะพัะพะด

#### `searchStreets(cityName, query)`
ะะพะธัะบ ัะปะธั ะฟะพ ะทะฐะฟัะพัั ะฒ ะบะพะฝะบัะตัะฝะพะผ ะณะพัะพะดะต.

```javascript
import { searchStreets } from '../services/citiesApi';

const results = await searchStreets('ืชื ืืืื - ืืคื', 'ืืื');
// ะะพะทะฒัะฐัะฐะตั: ['ืืืืืืืฃ']
```

**ะัะพะฑะตะฝะฝะพััะธ:**
- ะะฐะบัะธะผัะผ 15 ัะตะทัะปััะฐัะพะฒ
- ะะพะธัะบ ะฑะตะท ััะตัะฐ ัะตะณะธัััะฐ
- ะัะฟะพะปัะทัะตั ะบััะธัะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต

#### `getAddressInfo(cityName, streetName)`
ะะพะปััะธัั ะดะตัะฐะปัะฝัั ะธะฝัะพัะผะฐัะธั ะพะฑ ะฐะดัะตัะต.

```javascript
import { getAddressInfo } from '../services/citiesApi';

const info = await getAddressInfo('ืชื ืืืื - ืืคื', 'ืืืืืืืฃ');
// ะะพะทะฒัะฐัะฐะตั ะพะฑัะตะบั ั ะฟะพะปะฝะพะน ะธะฝัะพัะผะฐัะธะตะน ะพะฑ ะฐะดัะตัะต
```

#### `clearStreetsCache()`
ะัะธััะธัั ะบัั ัะปะธั (ะฟะพะปะตะทะฝะพ ะฟัะธ ัะผะตะฝะต ะณะพัะพะดะฐ).

```javascript
import { clearStreetsCache } from '../services/citiesApi';

clearStreetsCache(); // ะัะธัะฐะตั ะฒะตัั ะบัั ัะปะธั
```

## ๐งฉ ะะพะผะฟะพะฝะตะฝั StreetAutocomplete

### Props

| Prop | Type | Required | Default | Description |
|------|------|----------|---------|-------------|
| `value` | string | Yes | - | ะขะตะบััะตะต ะทะฝะฐัะตะฝะธะต |
| `onChange` | function | Yes | - | Callback ะฟัะธ ะธะทะผะตะฝะตะฝะธะธ |
| `cityName` | string | Yes | - | ะะฐะทะฒะฐะฝะธะต ะณะพัะพะดะฐ ะดะปั ัะธะปัััะฐัะธะธ |
| `placeholder` | string | No | 'ืืงืื ืฉื ืจืืื' | ะขะตะบัั placeholder |
| `className` | string | No | '' | CSS ะบะปะฐััั |
| `required` | boolean | No | false | ะะฑัะทะฐัะตะปัะฝะพะต ะฟะพะปะต |
| `error` | boolean | No | false | ะคะปะฐะณ ะพัะธะฑะบะธ |
| `disabled` | boolean | No | false | ะัะบะปััะธัั ะฟะพะปะต |

### ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

#### ะะฐะทะพะฒัะน ะฟัะธะผะตั
```jsx
import { StreetAutocomplete } from '../components/ui';

function AddressForm() {
    const [city, setCity] = useState('ืชื ืืืื - ืืคื');
    const [street, setStreet] = useState('');
    
    return (
        <StreetAutocomplete
            value={street}
            onChange={setStreet}
            cityName={city}
            placeholder="ืืงืื ืฉื ืจืืื"
            required
        />
    );
}
```

#### ะก ะฒะฐะปะธะดะฐัะธะตะน
```jsx
function AddressFormWithValidation() {
    const [formData, setFormData] = useState({
        city: '',
        street: ''
    });
    const [errors, setErrors] = useState({});
    
    const handleStreetChange = (street) => {
        setFormData({ ...formData, street });
        
        if (!street) {
            setErrors({ ...errors, street: 'ืจืืื ืืื ืฉืื ืืืื' });
        } else {
            const { street: _, ...rest } = errors;
            setErrors(rest);
        }
    };
    
    return (
        <>
            {/* ะกะฝะฐัะฐะปะฐ ะฒัะฑะพั ะณะพัะพะดะฐ */}
            <CityAutocomplete
                value={formData.city}
                onChange={(city) => setFormData({ ...formData, city })}
                error={!!errors.city}
                required
            />
            
            {/* ะะฐัะตะผ ะฒัะฑะพั ัะปะธัั */}
            <StreetAutocomplete
                value={formData.street}
                onChange={handleStreetChange}
                cityName={formData.city}
                error={!!errors.street}
                required
            />
            
            {errors.street && (
                <span className="error">{errors.street}</span>
            )}
        </>
    );
}
```

#### ะะพะปะฝัะน ะฐะดัะตั ั ะฝะพะผะตัะพะผ ะดะพะผะฐ
```jsx
function FullAddressForm() {
    const [address, setAddress] = useState({
        city: '',
        street: '',
        houseNumber: ''
    });
    
    return (
        <div className="grid grid-cols-3 gap-4">
            <CityAutocomplete
                value={address.city}
                onChange={(city) => setAddress({ ...address, city })}
                required
            />
            
            <StreetAutocomplete
                value={address.street}
                onChange={(street) => setAddress({ ...address, street })}
                cityName={address.city}
                required
            />
            
            <Input
                value={address.houseNumber}
                onChange={(e) => setAddress({ ...address, houseNumber: e.target.value })}
                placeholder="ืืกืคืจ ืืืช"
            />
        </div>
    );
}
```

## ๐ ะะพะฒะตะดะตะฝะธะต ะบะพะผะฟะพะฝะตะฝัะฐ

### ะะฐะฒะธัะธะผะพััั ะพั ะณะพัะพะดะฐ
- ะะพะปะต ัะปะธัั **ะพัะบะปััะตะฝะพ** ะฟะพะบะฐ ะฝะต ะฒัะฑัะฐะฝ ะณะพัะพะด
- ะัะธ ะพััััััะฒะธะธ ะณะพัะพะดะฐ ะฟะพะบะฐะทัะฒะฐะตััั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต: "ืชืืืื ืืืจ ืขืืจ"
- ะัะธ ัะผะตะฝะต ะณะพัะพะดะฐ ะฟะพะปะต ัะปะธัั ะพััะฐะตััั ะฐะบัะธะฒะฝัะผ

### ะะพะธัะบ
1. ะะพะปัะทะพะฒะฐัะตะปั ะฒะฒะพะดะธั ะผะธะฝะธะผัะผ 2 ัะธะผะฒะพะปะฐ
2. ะะถะธะดะฐะฝะธะต 300ms (debounce)
3. ะะพะธัะบ ััะตะดะธ ัะปะธั ะฒัะฑัะฐะฝะฝะพะณะพ ะณะพัะพะดะฐ
4. ะัะพะฑัะฐะถะตะฝะธะต ะดะพ 15 ัะตะทัะปััะฐัะพะฒ

### ะัะพะฑัะฐะถะตะฝะธะต ัะตะทัะปััะฐัะพะฒ
```
ืืืืืืืฃ (ืชื ืืืื - ืืคื)
```
ะะฐะถะดัะน ัะตะทัะปััะฐั ะฟะพะบะฐะทัะฒะฐะตั ะฝะฐะทะฒะฐะฝะธะต ัะปะธัั ะธ ะณะพัะพะด ะฒ ัะบะพะฑะบะฐั.

## ๐จ ะกัะธะปะธะทะฐัะธั

ะะพะผะฟะพะฝะตะฝั ะธัะฟะพะปัะทัะตั ัะต ะถะต ััะธะปะธ ััะพ ะธ CityAutocomplete:
- ะะพะดะดะตัะถะบะฐ ัะตะผะฝะพะน ัะตะผั
- RTL layout ะดะปั ะธะฒัะธัะฐ
- ะะดะฐะฟัะธะฒะฝัะน ะดะธะทะฐะนะฝ
- ะะฝะธะผะฐัะธะธ ะฟัะธ ะฒะทะฐะธะผะพะดะตะนััะฒะธะธ

### ะกะพััะพัะฝะธั
- **Normal**: ะกัะฐะฝะดะฐััะฝะพะต ัะพััะพัะฝะธะต
- **Disabled**: ะะพัะพะด ะฝะต ะฒัะฑัะฐะฝ
- **Focus**: ะัะธ ัะพะบััะต
- **Error**: ะัะธ ะพัะธะฑะบะต ะฒะฐะปะธะดะฐัะธะธ
- **Loading**: ะะพ ะฒัะตะผั ะฟะพะธัะบะฐ

## ๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### ะััะธัะพะฒะฐะฝะธะต
- **ะะพัะพะดะฐ**: ะัั ะฝะฐ 24 ัะฐัะฐ (ะพะฑัะธะน)
- **ะฃะปะธัั**: ะัั ะฝะฐ 24 ัะฐัะฐ (ะพัะดะตะปัะฝะพ ะดะปั ะบะฐะถะดะพะณะพ ะณะพัะพะดะฐ)
- **ะะฐะผััั**: ะญััะตะบัะธะฒะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ั ะฐะฒัะพะพัะธััะบะพะน

### ะะฟัะธะผะธะทะฐัะธั
```javascript
// ะัะธััะบะฐ ะบััะฐ ัะปะธั ะฟัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ
import { clearStreetsCache } from '../services/citiesApi';

// ะะฐะฟัะธะผะตั, ะฟะพัะปะต ะฒััะพะดะฐ ะฟะพะปัะทะพะฒะฐัะตะปั
function handleLogout() {
    clearStreetsCache();
    logout();
}
```

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะััะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต
1. ะัะบัะพะนัะต `test-streets-api.html` ะฒ ะฑัะฐัะทะตัะต
2. ะัะฑะตัะธัะต ะณะพัะพะด
3. ะะฒะตะดะธัะต ัะฐััั ะฝะฐะทะฒะฐะฝะธั ัะปะธัั
4. ะัะพะฒะตัััะต ัะตะทัะปััะฐัั

### ะัะธะผะตัั ัะตััะพะฒัั ะดะฐะฝะฝัั

**ะขะตะปั-ะะฒะธะฒ:**
- ืืืืืืืฃ
- ืืืืื
- ืื ืืืืื
- ืจืืืฉืืื

**ะะตัััะฐะปะธะผ:**
- ืืคื
- ืืืืื
- ืื ืืืืื
- ืืืื ื'ืืจื'

**ะฅะฐะนัะฐ:**
- ืืจืฆื
- ืืืคืืจ
- ืืืฉืื
- ืฉืืจืืช ืืืฉืื

## โ๏ธ ะะฐะถะฝัะต ะทะฐะผะตัะฐะฝะธั

1. **ะัะฑะพั ะณะพัะพะดะฐ ะพะฑัะทะฐัะตะปะตะฝ** - StreetAutocomplete ะฝะต ัะฐะฑะพัะฐะตั ะฑะตะท ะณะพัะพะดะฐ
2. **ะะพััะดะพะบ ะบะพะผะฟะพะฝะตะฝัะพะฒ** - ะกะฝะฐัะฐะปะฐ CityAutocomplete, ะทะฐัะตะผ StreetAutocomplete
3. **ะััะธัะพะฒะฐะฝะธะต** - ะัะธ ะฟะตัะฒะพะผ ะฟะพะธัะบะต ะผะพะถะตั ะฑััั ะทะฐะดะตัะถะบะฐ, ะทะฐัะตะผ ะดะฐะฝะฝัะต ะฑะตััััั ะธะท ะบััะฐ
4. **ะะธะผะธัั API** - ะะฐะทัะผะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต API ะฑะปะฐะณะพะดะฐัั ะบััะธัะพะฒะฐะฝะธั

## ๐ API Endpoint

### ะะพัะพะดะฐ
```
GET https://data.gov.il/api/3/action/datastore_search
  ?resource_id=5c78e9fa-c2e2-4771-93ff-7f400a12f7ba
  &filters={"ืฉื_ืืฉืื":"ืชื ืืืื - ืืคื"}
  &limit=1500
```

### ะฃะปะธัั (ะะะะซะ ะะะะะะะฌะะซะ API)
```
GET https://data.gov.il/api/3/action/datastore_search
  ?resource_id=e3674e3f-7f66-4b3b-a0c4-859b5d44b58e
  &filters={"ืฉื_ืืฉืื":"ืชื ืืืื - ืืคื"}
  &limit=5000
```

**โ๏ธ ะะฐะถะฝะพ:** ะะปั ัะปะธั ะธัะฟะพะปัะทัะตััั ะพัะดะตะปัะฝัะน resource_id!

### ะะฐัะฐะผะตััั ัะธะปัััะฐัะธะธ
- `ืฉื_ืืฉืื` - ะะฐะทะฒะฐะฝะธะต ะณะพัะพะดะฐ
- `ืฉื_ืจืืื` - ะะฐะทะฒะฐะฝะธะต ัะปะธัั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

### ะัะธะผะตั ะพัะฒะตัะฐ
```json
{
  "success": true,
  "result": {
    "records": [
      {
        "ืฉื_ืืฉืื": "ืชื ืืืื - ืืคื",
        "ืฉื_ืจืืื": "ืืืืืืืฃ",
        "ืกืื_ืืฉืื": "5000",
        "ืกืื_ืจืืื": "1234"
      }
    ]
  }
}
```

## ๐ก ะัััะธะต ะฟัะฐะบัะธะบะธ

1. **ะัะตะณะดะฐ ะฟัะพะฒะตััะนัะต ะฝะฐะปะธัะธะต ะณะพัะพะดะฐ**
   ```javascript
   if (city && city.trim()) {
       // ะะพะบะฐะทะฐัั StreetAutocomplete
   }
   ```

2. **ะะฑัะฐะฑะฐััะฒะฐะนัะต ะพัะธะฑะบะธ**
   ```javascript
   try {
       const streets = await getStreetsByCity(city);
   } catch (error) {
       console.error('ะัะธะฑะบะฐ ะทะฐะณััะทะบะธ ัะปะธั:', error);
       toast.error('ืฉืืืื ืืืขืืืช ืจืืืืืช');
   }
   ```

3. **ะัะฟะพะปัะทัะนัะต loading ัะพััะพัะฝะธะต**
   ```javascript
   const [isLoadingStreets, setIsLoadingStreets] = useState(false);
   ```

4. **ะัะธัะฐะนัะต ะฟะพะปะต ัะปะธัั ะฟัะธ ัะผะตะฝะต ะณะพัะพะดะฐ**
   ```javascript
   const handleCityChange = (newCity) => {
       setCity(newCity);
       setStreet(''); // ะัะธััะธัั ัะปะธัั
   };
   ```

## ๐ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะัะพะฑะปะตะผะฐ: ะฃะปะธัั ะฝะต ะทะฐะณััะถะฐัััั
**ะะตัะตะฝะธะต:** 
- ะัะพะฒะตัััะต, ััะพ ะณะพัะพะด ะฒัะฑัะฐะฝ ะฟัะฐะฒะธะปัะฝะพ
- ะฃะฑะตะดะธัะตัั ะฒ ะฟะพะดะบะปััะตะฝะธะธ ะบ ะธะฝัะตัะฝะตัั
- ะัะพะฒะตัััะต ะบะพะฝัะพะปั ะฝะฐ ะฝะฐะปะธัะธะต ะพัะธะฑะพะบ API

### ะัะพะฑะปะตะผะฐ: ะะพะปะต ัะปะธัั ะพัะบะปััะตะฝะพ
**ะะตัะตะฝะธะต:** 
- ะกะฝะฐัะฐะปะฐ ะฒัะฑะตัะธัะต ะณะพัะพะด
- ะัะพะฒะตัััะต, ััะพ `cityName` prop ะฟะตัะตะดะฐะฝ ะบะพััะตะบัะฝะพ

### ะัะพะฑะปะตะผะฐ: ะะตะทัะปััะฐัั ะฝะต ะพะฑะฝะพะฒะปััััั
**ะะตัะตะฝะธะต:**
- ะัะธััะธัะต ะบัั: `clearStreetsCache()`
- ะะตัะตะทะฐะณััะทะธัะต ัััะฐะฝะธัั

### ะัะพะฑะปะตะผะฐ: ะะพะปะณะฐั ะทะฐะณััะทะบะฐ ะฟะตัะฒัะน ัะฐะท
**ะะตัะตะฝะธะต:**
- ะญัะพ ะฝะพัะผะฐะปัะฝะพ - ะดะฐะฝะฝัะต ะทะฐะณััะถะฐัััั ะธ ะบััะธัััััั
- ะะพัะปะตะดัััะธะต ะฟะพะธัะบะธ ะฑัะดัั ะฑัััััะผะธ
